# this script is used to push large trees using git
# it pushes every commit from a specified branch
# to a specified remote branch one by one

REMOTE=$1
BRANCH=$2
REMOTE_BRANCH=$3

N=$(git rev-list --count --all)

for (( i=$N-1; i>=1; i-- ))
do
	commit_num=$BRANCH"~"$i
	sha=$(git log $commit_num | grep -m1 "commit")
	sha="${sha//commit }"
	echo "pushing "$sha

	git push $REMOTE $sha:$REMOTE_BRANCH
done

echo "pushing master last commit"
git push origin master
